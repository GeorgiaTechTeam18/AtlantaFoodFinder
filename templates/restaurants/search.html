{% extends 'UserAuth/base.html' %}

{% block body %}
    <form method="get">
        <label for="q">Restaurant Search</label><br>
        <input type="text" id="q" name="q" ><br>
        <input type="submit" value="Submit">
    </form>
    <ol id="searchResultsList">
        {% include 'restaurants/searchResultsItems.html' %}
    </ol>
    <button style="display: none" id="loadMore" onclick="loadMore()">
    More
    </button>
    <script>
    let pageToken = "{{ searchResults.nextPageToken }}";
    if(pageToken.length !== 0){
        document.getElementById("loadMore").style.display = "block"
    }
    function loadMore() {
        fetch("/restaurants/?q={{ query }}&pageToken=" + pageToken)
            .then(x => x.json())
            .then(x => {
                document.getElementById("searchResultsList").innerHTML += x.additionalHtml
                pageToken = x.nextPageToken
                if(pageToken.length === 0){
                    document.getElementById("loadMore").style.display = "none"
                }
            })
    }
    </script>
{% endblock %}
